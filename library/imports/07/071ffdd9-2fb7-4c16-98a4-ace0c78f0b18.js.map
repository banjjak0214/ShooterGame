{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\game/assets\\script\\game\\endBlock.js"],"names":["GameData","require","cc","Class","extends","Component","properties","lblVal","Label","deadAudio","AudioClip","start","node","on","explore","update","dt","parent","y","endLine","removeFromParent","onCollisionEnter","other","self","exploreALL","name","_isSound","audioEngine","play","active","score","_value","game","changeScoreView","init","val","isSound","txtVal","Math","round","string","blastPool","size","blast","get","setPosition","x","color","Color","getComponent","ParticleSystem","startColor","endColor","resetSystem","scheduleOnce","put"],"mappings":";;;;;;AAAA;AACA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAOL,GAAGM,KADF;AAERC,mBAAUP,GAAGQ;AAFL,KAHP;;AAQLC,SARK,mBAQI;AACL,aAAKC,IAAL,CAAUC,EAAV,CAAa,SAAb,EAAwB,YAAU;AAC9B,iBAAKC,OAAL;AACH,SAFD,EAEG,IAFH;AAGH,KAZI;AAcLC,UAdK,kBAcGC,EAdH,EAcO;AACR,YAAG,KAAKJ,IAAL,CAAUK,MAAV,CAAiBC,CAAjB,GAAqB,KAAKN,IAAL,CAAUM,CAA/B,GAAmClB,SAASmB,OAA/C,EAAuD;AACnD,iBAAKP,IAAL,CAAUQ,gBAAV;AACH;AACJ,KAlBI;AAoBLC,oBApBK,4BAoBYC,KApBZ,EAoBmBC,IApBnB,EAoByB;AAC1B;AACA,YAAGvB,SAASwB,UAAZ,EAAwB;AACxB,YAAIF,MAAMV,IAAN,CAAWa,IAAX,IAAmB,SAAnB,IAAgCH,MAAMV,IAAN,CAAWa,IAAX,IAAmB,SAAnD,IAAgEH,MAAMV,IAAN,CAAWa,IAAX,IAAmB,SAAvF,EAAkG;AAC9F,gBAAG,KAAKC,QAAR,EAAiB;AACbxB,mBAAGyB,WAAH,CAAeC,IAAf,CAAoB,KAAKnB,SAAzB,EAAoC,KAApC,EAA2C,GAA3C;AACH;AACDa,kBAAMV,IAAN,CAAWiB,MAAX,GAAoB,KAApB;;AAEA7B,qBAAS8B,KAAT,IAAkB,KAAKC,MAAvB;AACA/B,qBAASgC,IAAT,CAAcC,eAAd;AACA;AACA,iBAAKnB,OAAL;AACA;AACH;AACJ,KAnCI;AAoCLoB,QApCK,gBAoCAC,GApCA,EAoCI;AACL,aAAKT,QAAL,GAAgB1B,SAASoC,OAAzB;AACA,aAAKL,MAAL,GAAcI,GAAd;AACA,YAAIE,SAASF,GAAb;AACA,YAAGE,UAAU,IAAb,EAAkB;AACdA,qBAASC,KAAKC,KAAL,CAAWF,SAAO,EAAlB,IAAsB,GAAtB,GAA4B,GAArC;AACH;AACD,aAAK9B,MAAL,CAAYiC,MAAZ,GAAqBH,MAArB;AACH,KA5CI;AA6CLvB,WA7CK,qBA6CI;AAAA;;AACL,aAAKF,IAAL,CAAUiB,MAAV,GAAmB,KAAnB;AACA,YAAI7B,SAASyC,SAAT,CAAmBC,IAAnB,KAA4B,CAAhC,EAAmC;AAC/B,gBAAIC,QAAQ3C,SAASyC,SAAT,CAAmBG,GAAnB,EAAZ;AACAD,kBAAME,WAAN,CAAkB,KAAKjC,IAAL,CAAUkC,CAA5B,EAA+B,KAAKlC,IAAL,CAAUM,CAAzC;AACAyB,kBAAM1B,MAAN,GAAe,KAAKL,IAAL,CAAUK,MAAzB;;AAEA,gBAAI8B,QAAQ,IAAI7C,GAAG8C,KAAP,CAAa,GAAb,EAAkB,GAAlB,EAAuB,CAAvB,CAAZ;AACAL,kBAAMM,YAAN,CAAmB/C,GAAGgD,cAAtB,EAAsCC,UAAtC,GAAmDJ,KAAnD;AACAJ,kBAAMM,YAAN,CAAmB/C,GAAGgD,cAAtB,EAAsCE,QAAtC,GAAiDL,KAAjD;;AAEAJ,kBAAMM,YAAN,CAAmB/C,GAAGgD,cAAtB,EAAsCG,WAAtC;AACA,iBAAKC,YAAL,CAAkB,YAAM;AACpBtD,yBAASyC,SAAT,CAAmBc,GAAnB,CAAuBZ,KAAvB;AACA,sBAAK/B,IAAL,CAAUQ,gBAAV;AACH,aAHD,EAGG,GAHH;AAIH;AACJ;AA9DI,CAAT","file":"endBlock.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\game","sourcesContent":["// var CHD = require(\"commonHandler\");\r\nvar GameData = require(\"gameData\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        lblVal:cc.Label,\r\n        deadAudio:cc.AudioClip\r\n    },\r\n    \r\n    start () {\r\n        this.node.on('explore', function(){\r\n            this.explore();\r\n        }, this);\r\n    },\r\n\r\n    update (dt) {\r\n        if(this.node.parent.y + this.node.y < GameData.endLine){\r\n            this.node.removeFromParent();\r\n        }\r\n    },\r\n\r\n    onCollisionEnter(other, self) {\r\n        // if(self.node.parent == null) return;\r\n        if(GameData.exploreALL) return;\r\n        if (other.node.name == 'cbullet' || other.node.name == 'rbullet' || other.node.name == 'lbullet') {\r\n            if(this._isSound){\r\n                cc.audioEngine.play(this.deadAudio, false, 0.5);\r\n            }\r\n            other.node.active = false;\r\n            \r\n            GameData.score += this._value;\r\n            GameData.game.changeScoreView();\r\n            // self.node.parent.parent.emit('changedScore');\r\n            this.explore();\r\n            // this.node.emit('explore');\r\n        }\r\n    },\r\n    init(val){\r\n        this._isSound = GameData.isSound;\r\n        this._value = val;\r\n        let txtVal = val;\r\n        if(txtVal >= 1000){\r\n            txtVal = Math.round(txtVal/10)/100 + 'K';\r\n        }\r\n        this.lblVal.string = txtVal;\r\n    },\r\n    explore(){\r\n        this.node.active = false;\r\n        if (GameData.blastPool.size() > 0) {\r\n            let blast = GameData.blastPool.get();\r\n            blast.setPosition(this.node.x, this.node.y);\r\n            blast.parent = this.node.parent;\r\n\r\n            let color = new cc.Color(250, 206, 0);\r\n            blast.getComponent(cc.ParticleSystem).startColor = color;\r\n            blast.getComponent(cc.ParticleSystem).endColor = color;\r\n\r\n            blast.getComponent(cc.ParticleSystem).resetSystem();\r\n            this.scheduleOnce(() => {\r\n                GameData.blastPool.put(blast);\r\n                this.node.removeFromParent();\r\n            }, 0.8);\r\n        } \r\n    }\r\n});\r\n"]}